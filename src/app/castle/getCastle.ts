import { CASTLE_SIZE, CASTLE_HEALTH, CASTLE_POSITION } from "./const";
import { Castle, CastleActions, CastleState } from "./interface";

const getCastleImage = (): HTMLImageElement => {
  const image = document.createElement("img");
  image.width = CASTLE_SIZE.width;
  image.height = CASTLE_SIZE.height;
  image.src =
    "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHCBUVEhUWFhUVGBgYHBgaHBocGBwcGhoZGRocGhoaFhwcJC4nHB8rIRgeJjgmKy8xNTU1GiU7QDszPy40NTEBDAwMEA8QHxISHjcrJSs/NjcxNDc2MTQ0Njc/ODU1NjQ9NDY3NDY0NDQ0NDQ0NDQ2ND00NDQ0NDQ0NDQ0ND02NP/AABEIALUBFgMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABQYDBAcCAQj/xAA+EAACAQIEAwQIBAYBAwUAAAABAgADEQQSITEFQVEGImFxBxMyQoGRkqFSscHRFBYjYoLwcpOi4RU1Q3Oy/8QAGQEBAAMBAQAAAAAAAAAAAAAAAAECAwQF/8QAJBEBAQACAgICAgIDAAAAAAAAAAECEQMSITFBUSJhBBMycYH/2gAMAwEAAhEDEQA/AOvxEQEREBERAREQEREBERAREQEREBERARMWLxC06bu18qKzm2psoLG3jYSuN24wwpCpkxGU21FI8zbe9t/GEyW+loianDeILXQOgYA29tcp1AYaeRm3Eu0WaIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIn20D5PoEReB9yz7PBa2phnAFydIEf2hxKU8JXaobJkZSbFvbGUaAa3LAfGcuVK5yI5cJ6pAUK1Blf1nrM3sZQMthY63nQ+1/DBVwlcgXdUZkuTlBTv+zfLc2te3Sc4wnFsQMMFWrUPdcADYhVOnXXKfqkZb14a8Wt10TsNf+EF7+0SCeYKqRbw1lhtIfsi18JSNmHdUd4knRR1k3InpTL/ACrxE9ETzLKkREBERAREQEREBERAREQEREBERAREQEREBERAREQPs+ExEBERA18e2WlUOmiudf8AiZE4rjlH1Ay1qJchO56xSb3FwBvfflPvbTHihgK7mxuuQA7FnOUDTznDafFMRlWpkpWNYpbItuVhcDNubXlbMr6Xx18v0JxYgYetcgD1b3PId0zlvAauVcNmAAzgb73ew0t/dLxiMYuJ4O9QEAPhnuehyENf4zmmApKVoWJuCrDT3g4tvy8fCTlfx0txTzXasE4NNLbWA8raEfAi02AZFdnQf4Zc2+ZydubseXnJUCRjdyKZTWVj7eeSJ6iWVeIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICRHDOKipVqIDfLVqp19gJ8tzJecJ7LcZOH4mpqVLK9WoKhOilmJDMQToSflaRZb6WmvO1i9M/FdMPhlOpYVG16EBQfnKyq0xSCZe8Mrg20zhjUve3920he1fFzisdVq30zBV8FXl9zLknZ6p/D+uI7gG+l/weZ1sJpnNSfs4r5r36POMX4djsM5HcSoVG3ddSG+N9fjPuGxNFDRpnLmfMwFt8tSwseVrHTxM5/wXEGniSASofOjcu6QSQdOZA0/Pne6HEafq1UZr2I98C9zbYgfaRy468xbhvw6lwKrmpXGwZwD1F7g/eSV5FcExaVA7IxYaXuCLNqGGvlykpMuO7xiuf8AlXoT7Pgn0y6rwYn0z5AREQEREBERAREQEREBERAREQEREBERARE+KwOxBgfYiICJ4SqpJUMCV3F9R5iencKpJ2AJPkBeAZgBc7DX4Tj+GwtGr/EVwAyu9cgld1LPY2YaaWOs6ng6pq4VGQ5WemCp3sWTQ/AmcgwyVMNTq4aqAmQd8A5resGf2hz75GnPaPcrTj1MptDUcbhwV/q32AtmJPTQDWdHbiiKgoFXPfUE+ra2rh9Da50I1+85nXwmHzWCg5iABbne332liq9sxmYrhFKqyAs1VsxtpcALl9w/KU5plbJhLffz8rY5Y4z87pEccxWHFZ0DHOrlbFX9pWykajwlkwFNGpqe6DfTTe29pGcTbCuaj+pRXchwcuoL2ca28eclOEUC9IMuys/3Fv1lrlLhFsJey+Uqy0q9U5SRZNEW5AI1IUanUbDXWTlNwwBGx8CPsdRKhiuHF+JBw5UCnQva+uWo7cj1W3x8JcpjwXxZ9Kcs9UQ3+/20nuQ/Z3HislUi3crVk06BzY79DJcma43c2zs1dPhnyIlkETGK4zlbNf8A4mx0vo23PaZICIiAiIgIiICIiAiIgIiICIiAiIgJr4NVyBgAM2psLXPU2nrF1wlN3Y2CIzE9AoJJ+0iuxmPavgMPUbRmUEjoekjVT8JuJ5d7FR1JHyBP6T1JQw4axzGwuGcX/wApBdv+J/w/DcQ4NnZDTS2+ep3BbyuT8J57DcZ/isPUqXuDWrZf+HrGyH6bStdv+LitgVWiVyPWqBnI1vSbTINAQfxX2t10mS71S/pZuwHEFrcPoEG5RFUjmLDnKX2o/wDccWvJjQuP8E/aYPR/2iXCK6VQGzi4Kk5rpstibAWJ1uNpj4/xOjXxNSvRDrm9UrhgBd1LAONdioX5S2M87W9VoU3pElwFIp52JA/ACw+6gSB4NSL4TEtpbMnK5unfYg7+yTMuIqNTw2JOoDslIb6s96lT7Jb/AClh7I8MJ4aGsLOzuTYezf1baHcZVNppM+s3+4rcO11+q2OH16TcPPrAmcBqYJAu2tgR10e2nSSvZhlXCqrMATVdSeQGxby0EoNJs+HxCe/T/qW5AIcrgeQckn+2bPBcVW9VZcuVSd162PXxnPz46ysn3tr/ABsrZN/Wl74hxtqeNwbLr69UZhtmCiqxX5sv2m1xLt8ppOqU3R2XKrBlurEEFhcHY2tpr4Sgcc4nUGOwlOpkP8OiapfZwrDPY75Qp5TLxvhoSpUsSAbuvQAjT4Db4TPHDrhL9rbmWVl+F+9HODCBmVmyuoLKWuC1lswB20uNJdqtVVF2IUXAuTYXOglL9G7O9P1l+4ypl7oFzYA3IJ2IbTylzrcuhIB8b3EnDtJeynJq5ePTJEw1lASw7o7o7ulrkDS20yotgBcnxNrnxNtJdm8Um7zjow//ACsySo9jeLnEYjHXa6iu6oNNFSyG1upF9est0SWe03XwRESUEREBERAREQEREBERAREQEREClelfioocOqID38QRSA/tPef/ALQR/kJ49FeLzYNE17o/I5T9rSqelyjWrY6il1WmlO63J1Zyc7MANPZA+HjPfYHGPQrKgXOHZVBB2J0Ja9tDYftNtY/1/tXWVy8enSeI8SVMZhaOmZ/Wv5KgVb/Ev9jMPbTigw3D8RVv3ghVfF37ifdr/Ccu4z2jFTjxqK3co2oqeRCk5j5esJ+AEl/SlUxGIahTUqlDL6wWN2d9jmA2C7DzJ6Ssw1Zv5N73J8KhwXtNXw2BqYeipzVlIz80U6Er/cRcDpe/KS3Z1S2DfDVVcBbVEbIzKCBsSAcoIPLqfjEVKSUqaIAA2VQxsRdt73b5S59mgppAEvlZHDZUJ0J1Gm7WOgmfPzdPU9t+Lg7e76YeyWGW9cFRcKl9B+GoP1mj6TMOfVUxTUli5sFF29t27oGvykj2iq4jCYqoMNhlak6pYtmUZiXBCDS4BYX6AA7GVftHxjF1aeZ0FF0YZHpswa7M2bW9xobXG95OF3Noynn0lOPcJz4d8OpGZXSoWbQZ8oB2ubZWC7X8JPdnrU8FTXMLIjBuSDISGWxN9TmN7fHS0jzUariHAIJBoKdTdhUqbg25BTvzkhga6lXpZRkpo93KgllZ1z5ByJLOBryG8pctTrf9t5jL5n+lbwPBymIrucrI+ygG4RyxdWuLa5SDbryuIpYT1asq5ihVbMy2DN6pBa+3I3tzvLPgqueolUoVD+uvT0NnVaJYcs2pfXT4TXU0RnDndaZAs2n9NRyEy5c/G759L8eEnieHPKeAqvXLu6s7tZu6SL2tYeA0A02EmO1OHxXqkpsi2C6uGtmW4GQA2uRcXt47XmLL/UXozkdPe5dJK8Rrl2ynOwGa1/GwIW502/ObdssrJ8Rh0xkt+Ul6PuKVMIhFVXNI6llswTzUa7b9NZZeP9q1anhmoM4zYoIbrYstMFqlh+Ei3z5SF4LRBS2Sobut9BlPjqfYHMbnoZA9rsPWSthvU02SnSBdS9u87ZQ9wLi4VFF+rGZ/29uS40y4ZhjLjt0/tXxtcPh6Tgg+sq0UW/MMwZj8EBPwm12i4suHwVfEXHcpsy+LEWQfFiB8Zxbtlx96tPAJ7tG5bXd7gKD5KP8Aulk7ZY44jg9FVcKBUp510LMtmyjfYNYnTcCbdZrbC73pGeiPiJSqysdH1J8Tuf8Aftz7YDOA9kcCVq9ypl0N7jW4IsAunQ3N7j46dv4LXzUVzMrNY+yfduculydrRnnjctRM48scd2eEhERIQREQEREBERAREQEREBERATzVaysegJ+QnqfHQMpVgCCCCDsQdCDA/PWPru73dqjnXV2LHyBJ6kzNwd7NoHBGQjKddD18N5h7Q8OSjiqyKSVR2UXN9Fc2+1hI6hRGp5DxudT/AOZrl5ThdVk4jg8mJcju3sQpUbZVzGw+Jv4yx0uMvigiuir6pbZ9TnDkkDlYi17a+1INKTFrja1he3M7C53Akhg2KHUDTyF7DTbrf4SbMrIY9e1rS4yGNQ94m29uV9vym9wSpW0y1MRlXLfLnIAAOYaddPnPGPqK5dlWwJA+XWWns049WDa9vHU38LeM4+e2Y7sdfBjMsrqtPF8TrV2RBWZlVMwY7klhfcA7WkVj+GV3UqqPUvkPdUn3tdvOYaOOZCbKbpmUaaWB2Ouu0mux+IU5cxf2be02+h5HwiS447+jxll1+3nhTlMVVDKVIOG0J1BV3uCLb38reMsGFoUjUxlxoD3fKxOn0j5SA4jkc1HCPma4Jy6m17MDe5Ou5mHg1QmmC2fMc6t5B2tpyNpGU7zsvj+N6p/FYtUXDBbX9XVY3/Eyga9fZEjsNiUYPnZUOVLZm0JChe6bDpIrGLeoWVX0uBobdLnXU7/MyDxJJZs1/I+PQS04pljqqZclxvhkeoTUQ3I18iCTuJj4irpUsWdgbMpvqVvrz89PKalytTYm1j18Z6auz1GJvvaxGw3sByEvJdzXpjcpq79pfh9B3AyfxGul1PPMG0Oca2uIxfE6zVDTpFnCe0GOYqxJUrYk5fZlk7MWYC1rj2iOvI2t/ukwnswfX13UrZ+8ARazlmY3sDYDMe9vry0nNlnJnZl8Oqcd6Sz/AKpuOpvUy57AoToMt7+I+B8JgxpyHLmLd1Lkm3INoOmxH/iW7iXZt1rM+dWuVAsAAUVfaYfizMe6OnwFd4/bNTBTK4UqTcHMotlJsN9/hNMeTtZJ6ZZ8ese19t/sniFD3YoBZgbuF3vsTvfn5zqHZismdbCkCVAulQNqFIKgcwMotOT8A4crkqwG2/TUG/ztOtdj+EU6bM6quaxsR/e2Zv28hIyk/sn2nd/pu/S2RETocZERAREQEREBERAREQEREBEQIH587WVc2LxDX3qVPL2zaRLVSFIB6HbptNzjdTNWc9XY/MmR+a6zez0rPlv4XF1Clxkvl/Cfav57Wmdqjk7i2b8Pu5fzzTV4Z7Am70Mmb0hjDMaXePevqbW8pbezGlMAc/AX6dddpUa5/p63PeP+mT/BK5Wkxy5j3RbYkEgGx8vynH/Km8dO7+JdZKvjKTCrUBZrCpV94i4LNv5Xm92YxlVGKAi6gWNtwb+1bynviij19Xcd8nXobHf4zFwg/wBV+hVfzO0nH8sFbOuaW4ViSyLnLs7M4Jvbvi7302Fun2mY4dXoBQ1RGanUqIVcglnIZQ9iCctjpc7zBhzoqpq7Gw20JO5Pl+U18ZxtqbFcPTouFurVKgzM9vaCjZV6SmU8ePDSWT2mMTXUpnyOO5TqWvpaobAb7i2vnzlZxSP6yrbYMo8tN1+UnOG8WTE0mITI6EK9PcLc2DKTqBfS3WaTBc9S2vsdP7pfHcRnq6qrVy7klmO1vKesANXud2/QTayC08YFN/8Akf0mmMc19rx2XUqL6ktbUHTTTX7yQ4mMX6x2pVnVMncACWD6cit7W+80OzVtDqRvoBYG/n0lkcam3TfSedzXrybepxyZYSKzj8VjEzE13Khl3CHuZdfd9rNKXxDiFWq6+sYNa/uqOY6S/cbUhGOpuPM7b+P+9Jzqt7Y8j+m06OGSzenL/I/G9ZfCwdmHtU1003v+YO401nVuyaBSVHPO2/NnLEW5WJM5J2dqf1lXTUHfS/K1xsdd/CdW7OVu+gueY11vp163leS65InGb4atcRE6nCREQEREBERAREQEREBFp8dgASdgCT5DWfnPG9oMUzsy4nELmJItUcWubiwvbnK55ddDqOP9JtCnUdPUVGyMyZgygEqSCQOmk2OD+kbB4gupLUmRc1nKgNfSyEHU3tpbnOL4hiSSbkk3J6km5JnjguJFPGIxNgwZW5aWuNvECZYZ27S3schJvyJ3uAPzmuU0O31L+8kuN49Hy5WYm+xOg0Nzp8JA037o15zpnLcpuzSOuvSSwC2WxI5+PPlabD11HP8AOaNAtcZUZt9h1tPVTC1Te6gXPMgdOW8mZ/RpmqVlKC3jvJPhXaGlTAVg2lrWF7n6pGUuDOQuYkeQ/e02P5eVTck+RI/SZZ495qtMM7hdwx/E0eo7IGAYg62B2A/SfeGHLVfUDuj8zD4FBoFHwAH6TQr8Lub2PzvLYceppGXNvLdTWGqlaiNe9s41I5q1rTRpuoyqTq1yPhI//wBHI90/aP8A0c+6LeUZcVqZza+Engq2XE1bAAvSBJvbUED9vlNkPZ3JOpC77k975yttw5gfZP3mJsGw5H5SZhqIvLtv4nFBB3jrfa/3AmLC8RVb6Hfw/eaLYJvGeqeFIFtd7ydWKXLa38K7S0U9pH8bDf4Xk43bDDMNQ5tb3LHTYXBnORhzyPXQ6TKtJxfuOfITLPgxyvat8P5OeM1F04pxRKtMkXGYaXVid7aG3hKi6EuLW6b85s53NJBewva1tu8d5o0+7UctspXMNtyJGOMxlkOTkudlqd4SjpUBdWA2O/8Ap8pf+D8dw6MmaqgsRcliNOZ1lMp8YpFcodhYCxYnfSYa3GO5o97ud9fdXa/nMspcruz0tjy3HG4/a8cW9KC0qzpTorVRTYOKtg2gNwMhsNes2+yfpFTGYoYdqJpsyuynOGBy6lfZBva5+E47iXLXJ1JufiZk7N4w0uJYJwdRWpr/AIucjD5NLYZ3LLy536XiIm6CIiAiIgIiICIiBixdEPTdDezqymxsbMCNDy3nOz2FwencfS3vtynSYlbjL7HNv5GwdrZH+tpgPo9wLMDke/8A9jTqERMZPQ5oPR/ggR3H/wCo/wC8z0uxuCUC1I/WT+c6JEsKH/KuF6OPDObfafU7JYUe631tL3ECk/yphujjydp5bsfhj7rn/NpeIiUURuxuFO6N9bT4exmE/A31tL5Et2qOsURex2EHuv8AW09t2Rwp91/raXiI7VHWKD/JeD/A/wBbTw3YnB/gf62nQYjtU6c7/kfB/gb62nw9h8H+B/radFiR2ppzkdhcH+B/raZE7GYMbK4/zadCiN1KjJ2VwwG1Qjxcnn4zXxXY3Bve9M8vfIvrztOgxIHMz6PcGfcf/qP+89J6P8GPcqbn/wCRvD9p0qIHN/5Hwf4H+tp5odg8GKtNwj5ldGX+o2hDAjT4TpUSsxk9AYiJYIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiB/9k=";
  return image;
};

const drawCastle = (state: CastleState, ctx: any): void => {
  state.image.onload = () => {
    ctx.drawImage(
      state.image,
      state.position.x,
      state.position.y,
      state.size.width,
      state.size.height
    );
  };
};

export const getCastle = (): Castle => {
  const state: CastleState = {
    position: CASTLE_POSITION,
    size: CASTLE_SIZE,
    health: CASTLE_HEALTH,
    image: getCastleImage(),
  };

  const actions: CastleActions = {
    getDamage(damageValue: number) {
      state.health = state.health - damageValue;
    },
    getHealth(healthValue: number) {
      state.health = state.health + healthValue;
    },
    drawCastle: (ctx: any) => {
      drawCastle(state, ctx);
    },
  };

  return {
    state,
    actions,
  };
};
